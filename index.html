<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –î–æ—Å—Ç–∞–≤–∫–∏</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* –ê–Ω—ñ–º–∞—Ü—ñ—è –ø–æ—è–≤–∏ */
    .fade-in { animation: fadeIn 0.4s ease-out forwards; opacity: 0; transform: translateY(10px); }
    @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body class="bg-slate-100 font-sans min-h-screen flex items-center justify-center p-4">

  <div class="w-full max-w-[480px] bg-white rounded-3xl shadow-xl overflow-hidden border border-slate-200">
    
    <div class="bg-slate-900 p-6 text-center">
      <h1 class="text-xl font-bold text-white mb-1">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –î–æ—Å—Ç–∞–≤–∫–∏</h1>
      <p class="text-slate-400 text-[10px] uppercase tracking-widest opacity-80">–õ—å–≤—ñ–≤ ‚Ä¢ –í–æ–ª–∏–Ω—å ‚Ä¢ –†—ñ–≤–Ω–µ ‚Ä¢ –¢–µ—Ä–Ω–æ–ø—ñ–ª—å ‚Ä¢ –ó–∞–∫–∞—Ä–ø–∞—Ç—Ç—è</p>
    </div>

    <div class="p-6 space-y-5">
      
      <div class="space-y-4">
        
        <div>
           <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1 ml-1 tracking-wider">–ó–≤—ñ–¥–∫–∏</label>
           <input type="text" value="–õ—å–≤—ñ–≤" disabled class="w-full bg-slate-100 border border-slate-200 text-slate-500 rounded-xl px-4 py-3 text-sm font-medium outline-none cursor-not-allowed" />
        </div>

        <div>
          <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1 ml-1 tracking-wider">–ö—É–¥–∏ (–ù–∞—Å–µ–ª–µ–Ω–∏–π –ø—É–Ω–∫—Ç)</label>
          <input id="city" type="text" class="w-full bg-white border border-slate-300 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent transition placeholder:text-slate-300" placeholder="–ù–∞–ø—Ä. –°—Ç—Ä–∏–π" />
        </div>

        <div>
          <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1 ml-1 tracking-wider">–û–±–ª–∞—Å—Ç—å</label>
          <div class="relative">
            <select id="region" class="w-full bg-white border border-slate-300 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 focus:ring-slate-900 focus:border-transparent transition appearance-none cursor-pointer">
              <option value="" disabled selected>–û–±–µ—Ä—ñ—Ç—å –æ–±–ª–∞—Å—Ç—å –∑—ñ —Å–ø–∏—Å–∫—É</option>
              <option value="–ª—å–≤—ñ–≤—Å—å–∫–∞">–õ—å–≤—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
              <option value="–≤–æ–ª–∏–Ω—Å—å–∫–∞">–í–æ–ª–∏–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
              <option value="—Ä—ñ–≤–Ω–µ–Ω—Å—å–∫–∞">–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
              <option value="—Ç–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞">–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
              <option value="–∑–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞">–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
              <option value="other">–Ü–Ω—à–∞ –æ–±–ª–∞—Å—Ç—å (–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ)</option>
            </select>
            <div class="absolute inset-y-0 right-0 flex items-center px-4 pointer-events-none">
              <svg class="w-4 h-4 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </div>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1 ml-1 tracking-wider">–í–∞–≥–∞ (–∫–≥)</label>
            <input id="weight" type="number" class="w-full bg-white border border-slate-300 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 focus:ring-slate-900 transition placeholder:text-slate-300" placeholder="0" />
          </div>
          <div>
            <label class="block text-[10px] font-bold text-slate-400 uppercase mb-1 ml-1 tracking-wider">–î–æ–≤–∂–∏–Ω–∞ (–º)</label>
            <input id="length" type="number" step="0.1" class="w-full bg-white border border-slate-300 rounded-xl px-4 py-3 text-sm outline-none focus:ring-2 focus:ring-slate-900 transition placeholder:text-slate-300" placeholder="0" />
          </div>
        </div>
      </div>

      <button onclick="calculate()" id="calcBtn" class="w-full bg-slate-900 text-white font-bold py-4 rounded-xl hover:bg-slate-800 active:scale-[0.98] transition-all shadow-lg shadow-slate-900/20 text-sm tracking-wide">
        –†–û–ó–†–ê–•–£–í–ê–¢–ò
      </button>

      <div id="resultCard" class="hidden fade-in border border-slate-200 rounded-2xl p-5 bg-slate-50 relative overflow-hidden">
        
        <div class="absolute top-4 right-4 bg-green-100 text-green-700 text-[10px] font-bold px-2 py-1 rounded uppercase tracking-wide">
          –ü–æ –º–∞—Ä—à—Ä—É—Ç—É
        </div>

        <div class="text-slate-500 text-xs font-medium mb-1">–û—Ä—ñ—î–Ω—Ç–æ–≤–Ω–∞ –≤–∞—Ä—Ç—ñ—Å—Ç—å:</div>
        <div id="finalPrice" class="text-4xl font-black text-slate-900 tracking-tight mb-4">0 –≥—Ä–Ω</div>

        <div class="space-y-2 border-t border-slate-200 pt-3">
          <div class="flex justify-between text-xs">
             <span class="text-slate-500">–í—ñ–¥—Å—Ç–∞–Ω—å (–≤ –æ–¥–∏–Ω –±—ñ–∫):</span>
             <span id="distDisplay" class="font-bold text-slate-700">0 –∫–º</span>
          </div>
          <div class="flex justify-between text-xs">
             <span class="text-slate-500">–¢–∏–ø –∞–≤—Ç–æ:</span>
             <span id="carType" class="font-bold text-slate-700">‚Äî</span>
          </div>
          <div class="flex justify-between text-xs" id="longLoadRow">
             <span class="text-slate-500">–ì–∞–±–∞—Ä–∏—Ç:</span>
             <span id="lengthStatus" class="font-bold text-slate-700">‚Äî</span>
          </div>
        </div>

        <div id="deliveryWarning" class="hidden mt-4 pt-3 border-t border-blue-100">
           <a href="https://www.delivery-auto.com/uk/CalculateCost" target="_blank" class="block bg-blue-50 hover:bg-blue-100 transition p-3 rounded-lg flex items-center gap-3 group">
              <span class="text-xl">üì¶</span>
              <div class="text-xs text-blue-800">
                 <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:</strong> –í–∞–Ω—Ç–∞–∂ –ª–µ–≥–∫–∏–π. <br>
                 <span class="underline decoration-blue-300 group-hover:decoration-blue-800">–†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ –≤–∞—Ä—Ç—ñ—Å—Ç—å –Ω–∞ Delivery</span>
              </div>
           </a>
        </div>
      </div>

      <div id="otherRegionWarning" class="hidden fade-in p-4 bg-amber-50 text-amber-900 text-xs rounded-xl border border-amber-100 text-center leading-relaxed">
        –ú–∏ —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ—Å—å –Ω–∞ –ó–∞—Ö—ñ–¥–Ω—ñ–π –£–∫—Ä–∞—ó–Ω—ñ. <br>
        –î–æ—Å—Ç–∞–≤–∫–∞ –≤ —Ü–µ–π —Ä–µ–≥—ñ–æ–Ω ‚Äî <strong>–≤—ñ–¥ 10 000 –≥—Ä–Ω</strong>.<br>
        –ó–≤'—è–∂—ñ—Ç—å—Å—è –∑ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ—Ä–∞—Ö—É–Ω–∫—É.
      </div>

      <div id="errorBox" class="hidden p-3 bg-red-50 text-red-600 text-xs rounded-xl text-center border border-red-100 font-medium"></div>

    </div>
  </div>

  <script>
    // --- –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø –õ–û–ì–Ü–ö–ò (–°–ï–†–¶–ï –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê) ---
    const LOGIC = {
      // –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ —Ü—ñ–Ω–∏ –ø–æ –æ–±–ª–∞—Å—Ç—è—Ö
      minPrice: {
        '–ª—å–≤—ñ–≤—Å—å–∫–∞': 2000,
        '–≤–æ–ª–∏–Ω—Å—å–∫–∞': 2500,
        '—Ä—ñ–≤–Ω–µ–Ω—Å—å–∫–∞': 2500,
        '—Ç–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞': 2500,
        '–∑–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞': 4000
      },
      ratePerKm: 14, 
      
      // –ù–∞—Ü—ñ–Ω–∫–∏
      fees: {
        mediumWeight: 1000,  // 500-1500 –∫–≥
        heavyWeight: 2500,   // > 1500 –∫–≥
        longLoad: 1500       // > 4 –º
      },
      zakarpattiaCoef: 1.2
    };

    let mapsReady = false;
    // –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ì—É–≥–ª–æ–º, –∫–æ–ª–∏ –∫–∞—Ä—Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–ª–∞—Å—å
    function initMaps() { mapsReady = true; console.log("Maps loaded"); }
    window.initMaps = initMaps;

    // –û–∫—Ä—É–≥–ª–µ–Ω–Ω—è –¥–æ 500
    function roundTo500(num) {
      return Math.ceil(num / 500) * 500;
    }

    // –ì–û–õ–û–í–ù–ê –§–£–ù–ö–¶–Ü–Ø –†–û–ó–†–ê–•–£–ù–ö–£
    async function calculate() {
      // –ï–ª–µ–º–µ–Ω—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
      const ui = {
        city: document.getElementById('city'),
        region: document.getElementById('region'),
        weight: document.getElementById('weight'),
        length: document.getElementById('length'),
        result: document.getElementById('resultCard'),
        price: document.getElementById('finalPrice'),
        dist: document.getElementById('distDisplay'),
        car: document.getElementById('carType'),
        lenStat: document.getElementById('lengthStatus'),
        lenRow: document.getElementById('longLoadRow'),
        err: document.getElementById('errorBox'),
        deliv: document.getElementById('deliveryWarning'),
        other: document.getElementById('otherRegionWarning'),
        btn: document.getElementById('calcBtn')
      };

      // –ó—á–∏—Ç—É—î–º–æ –¥–∞–Ω—ñ
      const val = {
        city: ui.city.value.trim(),
        region: ui.region.value,
        w: parseFloat(ui.weight.value) || 0,
        l: parseFloat(ui.length.value) || 0
      };

      // –°–∫–∏–¥–∞—î–º–æ –≤–∏–≥–ª—è–¥
      ui.err.classList.add('hidden');
      ui.result.classList.add('hidden');
      ui.other.classList.add('hidden');
      ui.deliv.classList.add('hidden');

      // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
      if (!val.city || !val.region) {
        ui.err.textContent = "–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–∫–∞–∂—ñ—Ç—å –º—ñ—Å—Ç–æ —Ç–∞ –æ–±–ª–∞—Å—Ç—å.";
        ui.err.classList.remove('hidden');
        return;
      }

      if (val.region === 'other') {
        ui.other.classList.remove('hidden');
        return;
      }

      if (!mapsReady) {
        ui.err.textContent = "–°–∏—Å—Ç–µ–º–∞ –∫–∞—Ä—Ç —â–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è, —Å–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É...";
        ui.err.classList.remove('hidden');
        return;
      }

      // –ë–ª–æ–∫—É—î–º–æ –∫–Ω–æ–ø–∫—É –Ω–∞ —á–∞—Å —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É
      const originalBtnText = ui.btn.innerText;
      ui.btn.innerText = "–†–ê–•–£–Ñ–ú–û...";
      ui.btn.disabled = true;
      ui.btn.classList.add('opacity-70');

      try {
        // –ó–∞–ø–∏—Ç –¥–æ Google Maps
        const distKm = await getDistanceKm("–õ—å–≤—ñ–≤, –£–∫—Ä–∞—ó–Ω–∞", `${val.city}, ${val.region}, –£–∫—Ä–∞—ó–Ω–∞`);
        
        // --- –õ–û–ì–Ü–ö–ê –†–û–ó–†–ê–•–£–ù–ö–£ ---
        let price = distKm * LOGIC.ratePerKm;
        
        // 1. –ö–æ—Ä–∏–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –±–ª–∏–∑—å–∫–∏—Ö –≤—ñ–¥—Å—Ç–∞–Ω–µ–π (–¥–æ 50 –∫–º - —Ñ—ñ–∫—Å –º—ñ–Ω—ñ–º–∞–ª–∫–∞)
        if (distKm < 50) price = LOGIC.minPrice[val.region];

        // 2. –†–µ–≥—ñ–æ–Ω–∞–ª—å–Ω–∏–π –º—ñ–Ω—ñ–º—É–º (–Ω–µ –º–µ–Ω—à–µ –Ω—ñ–∂...)
        if (price < LOGIC.minPrice[val.region]) price = LOGIC.minPrice[val.region];

        // 3. –í–∞–≥–∞
        let carLabel = "–ë—É—Å –¥–æ 1.5—Ç";
        if (val.w <= 500) {
           carLabel = "–õ–µ–≥–∫–∏–π –≤–∞–Ω—Ç–∞–∂";
        } else if (val.w > 500 && val.w <= 1500) {
           price += LOGIC.fees.mediumWeight;
           carLabel = "–ë—É—Å (–¥–æ 1.5—Ç)";
        } else {
           price += LOGIC.fees.heavyWeight;
           carLabel = "–í–∞–Ω—Ç–∞–∂—ñ–≤–∫–∞ (>1.5—Ç)";
        }

        // 4. –î–æ–≤–∂–∏–Ω–∞ (–ù–µ–≥–∞–±–∞—Ä–∏—Ç)
        let isLong = false;
        if (val.l > 4.05) { 
           isLong = true;
           price += LOGIC.fees.longLoad;
           ui.lenStat.textContent = "> 4–º (–ù–µ–≥–∞–±–∞—Ä–∏—Ç)";
           ui.lenStat.className = "font-bold text-red-600";
        } else {
           ui.lenStat.textContent = "–°—Ç–∞–Ω–¥–∞—Ä—Ç";
           ui.lenStat.className = "font-bold text-slate-700";
        }

        // 5. –ó–∞–∫–∞—Ä–ø–∞—Ç—Ç—è
        if (val.region === '–∑–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞') {
           price = Math.max(price, 4000); 
           if (distKm > 200 && val.w > 500) price *= LOGIC.zakarpattiaCoef;
        }

        // 6. –û–∫—Ä—É–≥–ª–µ–Ω–Ω—è
        const finalPrice = roundTo500(price);

        // 7. –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
        ui.price.textContent = finalPrice.toLocaleString('uk-UA') + " –≥—Ä–Ω";
        ui.dist.textContent = distKm.toFixed(0) + " –∫–º";
        ui.car.textContent = carLabel;
        
        // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è –î–µ–ª—ñ–≤–µ—Ä—ñ
        if (val.w > 0 && val.w < 200 && distKm > 100) {
          ui.deliv.classList.remove('hidden');
        }

        ui.result.classList.remove('hidden');

      } catch (error) {
        console.error(error);
        ui.err.textContent = "–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ–∫–ª–∞—Å—Ç–∏ –º–∞—Ä—à—Ä—É—Ç. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–∑–≤—É –º—ñ—Å—Ç–∞.";
        ui.err.classList.remove('hidden');
      } finally {
        // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–Ω–æ–ø–∫—É
        ui.btn.innerText = originalBtnText;
        ui.btn.disabled = false;
        ui.btn.classList.remove('opacity-70');
      }
    }

    // –î–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –∫–∞—Ä—Ç
    function getDistanceKm(origin, dest) {
      return new Promise((resolve, reject) => {
        const svc = new google.maps.DistanceMatrixService();
        svc.getDistanceMatrix({
          origins: [origin],
          destinations: [dest],
          travelMode: 'DRIVING'
        }, (res, status) => {
          if (status !== 'OK') return reject(status);
          const el = res.rows[0].elements[0];
          if (el.status !== 'OK') return reject(el.status);
          resolve(el.distance.value / 1000);
        });
      });
    }
  </script>
  
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDFR9n0yr9SEPDWGyH1G_dDJBit7bxvy_Y&libraries=places&callback=initMaps" async defer></script>
</body>
</html>
